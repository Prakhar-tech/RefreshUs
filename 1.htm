<div> 
    
    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>Document</title>


<link rel="stylesheet" href="css/movie-page.css">

</head>
<body>
  <div class="ultimate" id="output">

   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
      <link rel="stylesheet" href="css/movie-page.css">
      <header>

       <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="/">RefreshUs</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" style="margin: 0%;">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0 me-5">
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="/dashboard">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" href="/movies">Movies</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/webseries">Webseries</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/games">Games</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/contact">Suggestions</a>
              </li>
            </ul>

            <ul class="navbar-nav me-2 mb-2 mb-lg-0">
             <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="far fa-user"> Welcome Prakhar Srivastava</i>
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            <li><a class="dropdown-item" href="/profile">Profile</a></li>
            <li><a class="dropdown-item" href="/auth/logout">Logout</a></li>
          </ul>
        </li>
            </ul>
          </div>
        </div>
      </nav>
</header>
<div class="sort">
  <form class="d-flex form form" id="form">
            
    <div class = 'search-box'>
    <input class = "search-text" type="text" placeholder = "Search Movie" id="searchMovie">
    <a href="#" type="submit" class = "search-btn">
     <i class="fas fa-search"></i>
    </a>         
  </div> 
  </form>
 <select class="nice-select" name="sort" multiple>
  <option>Sort by...</option>
  <option value="-rating">Rating: Descending</option>
  <option value="duration">Duration: Ascending</option>
  <option value="pop">Popularity</option>
  <option value="low">Price: Low to High</option>
  <option value="high">Price: High to Low</option>
</select>
</div>
  
  
<div class="wrapper" >
   
   
	<div class="main_card" >
		<div class="card_left">
			<div class="card_datails">
				<h1>Avengers Endgame</h1>
				<div class="card_cat">
					<p class="PG">Hollywood</p>
					<p class="year">2018</p>
					<p class="genre">Action</p>
					<p class="time">2h 28m</p>
				</div>
				<p class="disc">Spideramn movie, a great movie must watch u will be gihly obliged wit h this by watching...</p>
				<a href="https://www.imdb.com/title/tt4912910/" target="_blank">Read More</a>
			<div class="social-btn">
        <!-- WATCH TRAILER-->
				<button>
					<i class="fas fa-play"></i> SEE TRAILER
				</button>
				<!-- GET-->
				<button>
					<i class="fas fa-download"></i> DOWNLOAD
				</button>
				<!--USERS RATINGS-->
				<button>
					<i class="fas fa-star"></i> 9.9
				</button>
				<!--BOOKMARK-->
				<button onclick="getFav(this)" value="60e8add1660b9c5796bb0735" name="srivastava11735@gmail.com" style="background-color: #e50914;" id="x">
          <i class="fas fa-heart"></i>
				</button>
			</div>	
			</div>
		</div>
		<div class="card_right">
			<div class="img_container">
				<img src="https://lumiere-a.akamaihd.net/v1/images/p_avengersendgame_19751_e14a0104.jpeg?region&#x3D;0%2C0%2C540%2C810" alt="">
				</div>
				<div class="play_btn">
					<a href="https://www.imdb.com/title/tt4912910/" target="_blank">
						<i class="fas fa-play-circle"></i>
					</a>
				</div>
			</div>
		</div>
    
   
	<div class="main_card" >
		<div class="card_left">
			<div class="card_datails">
				<h1>Spiderman</h1>
				<div class="card_cat">
					<p class="PG">Hollywood</p>
					<p class="year">2018</p>
					<p class="genre">Action</p>
					<p class="time">2h 28m</p>
				</div>
				<p class="disc">Spideramn movie, a great movie must watch u will be gihly obliged wit h this by watching...</p>
				<a href="https://www.imdb.com/title/tt4912910/" target="_blank">Read More</a>
			<div class="social-btn">
        <!-- WATCH TRAILER-->
				<button>
					<i class="fas fa-play"></i> SEE TRAILER
				</button>
				<!-- GET-->
				<button>
					<i class="fas fa-download"></i> DOWNLOAD
				</button>
				<!--USERS RATINGS-->
				<button>
					<i class="fas fa-star"></i> 9.8
				</button>
				<!--BOOKMARK-->
				<button onclick="getFav(this)" value="60e7706b122d8f61944ae397" name="srivastava11735@gmail.com" style="background-color: #e50914;" id="x">
          <i class="fas fa-heart"></i>
				</button>
			</div>	
			</div>
		</div>
		<div class="card_right">
			<div class="img_container">
				<img src="https://upload.wikimedia.org/wikipedia/en/2/21/Web_of_Spider-Man_Vol_1_129-1.png" alt="">
				</div>
				<div class="play_btn">
					<a href="https://www.imdb.com/title/tt4912910/" target="_blank">
						<i class="fas fa-play-circle"></i>
					</a>
				</div>
			</div>
		</div>
    
   
	<div class="main_card" >
		<div class="card_left">
			<div class="card_datails">
				<h1>Lucy</h1>
				<div class="card_cat">
					<p class="PG">Hollywood</p>
					<p class="year">2018</p>
					<p class="genre">Romance</p>
					<p class="time">2h 28m</p>
				</div>
				<p class="disc">Spideramn movie, a great movie must watch u will be gihly obliged wit h this by watching...</p>
				<a href="https://www.imdb.com/title/tt4912910/" target="_blank">Read More</a>
			<div class="social-btn">
        <!-- WATCH TRAILER-->
				<button>
					<i class="fas fa-play"></i> SEE TRAILER
				</button>
				<!-- GET-->
				<button>
					<i class="fas fa-download"></i> DOWNLOAD
				</button>
				<!--USERS RATINGS-->
				<button>
					<i class="fas fa-star"></i> 8.0
				</button>
				<!--BOOKMARK-->
				<button onclick="getFav(this)" value="60e773eab8220043ac278848" name="srivastava11735@gmail.com" style="background-color: #e50914;" id="x">
          <i class="fas fa-heart"></i>
				</button>
			</div>	
			</div>
		</div>
		<div class="card_right">
			<div class="img_container">
				<img src="https://m.media-amazon.com/images/M/MV5BODcxMzY3ODY1NF5BMl5BanBnXkFtZTgwNzg1NDY4MTE@._V1_.jpg" alt="">
				</div>
				<div class="play_btn">
					<a href="https://www.imdb.com/title/tt4912910/" target="_blank">
						<i class="fas fa-play-circle"></i>
					</a>
				</div>
			</div>
		</div>
    
   
	<div class="main_card" >
		<div class="card_left">
			<div class="card_datails">
				<h1>Pirates Of Carriebean</h1>
				<div class="card_cat">
					<p class="PG">Hollywood</p>
					<p class="year">2018</p>
					<p class="genre">Action</p>
					<p class="time">2h 28m</p>
				</div>
				<p class="disc">Spideramn movie, a great movie must watch u will be gihly obliged wit h this by watching...</p>
				<a href="https://www.imdb.com/title/tt4912910/" target="_blank">Read More</a>
			<div class="social-btn">
        <!-- WATCH TRAILER-->
				<button>
					<i class="fas fa-play"></i> SEE TRAILER
				</button>
				<!-- GET-->
				<button>
					<i class="fas fa-download"></i> DOWNLOAD
				</button>
				<!--USERS RATINGS-->
				<button>
					<i class="fas fa-star"></i> 6.0
				</button>
				<!--BOOKMARK-->
				<button onclick="getFav(this)" value="60e8ae33660b9c5796bb0736" name="srivastava11735@gmail.com" style="background-color: #e50914;" id="x">
          <i class="fas fa-heart"></i>
				</button>
			</div>	
			</div>
		</div>
		<div class="card_right">
			<div class="img_container">
				<img src="https://m.media-amazon.com/images/M/MV5BMjE5MjkwODI3Nl5BMl5BanBnXkFtZTcwNjcwMDk4NA@@._V1_.jpg" alt="">
				</div>
				<div class="play_btn">
					<a href="https://www.imdb.com/title/tt4912910/" target="_blank">
						<i class="fas fa-play-circle"></i>
					</a>
				</div>
			</div>
		</div>
    
   
	<div class="main_card" >
		<div class="card_left">
			<div class="card_datails">
				<h1>Dhoom</h1>
				<div class="card_cat">
					<p class="PG">Hollywood</p>
					<p class="year">2018</p>
					<p class="genre">Action</p>
					<p class="time">2h 28m</p>
				</div>
				<p class="disc">Spideramn movie, a great movie must watch u will be gihly obliged wit h this by watching...</p>
				<a href="https://www.imdb.com/title/tt4912910/" target="_blank">Read More</a>
			<div class="social-btn">
        <!-- WATCH TRAILER-->
				<button>
					<i class="fas fa-play"></i> SEE TRAILER
				</button>
				<!-- GET-->
				<button>
					<i class="fas fa-download"></i> DOWNLOAD
				</button>
				<!--USERS RATINGS-->
				<button>
					<i class="fas fa-star"></i> 5.0
				</button>
				<!--BOOKMARK-->
				<button onclick="getFav(this)" value="60e8ab6d971bda2f806666ab" name="srivastava11735@gmail.com" style="background-color: #e50914;" id="x">
          <i class="fas fa-heart"></i>
				</button>
			</div>	
			</div>
		</div>
		<div class="card_right">
			<div class="img_container">
				<img src="https://scdn.nflximg.net/images/8099/3208099.jpg" alt="">
				</div>
				<div class="play_btn">
					<a href="https://www.imdb.com/title/tt4912910/" target="_blank">
						<i class="fas fa-play-circle"></i>
					</a>
				</div>
			</div>
		</div>
    
   
	<div class="main_card" >
		<div class="card_left">
			<div class="card_datails">
				<h1>Gajni</h1>
				<div class="card_cat">
					<p class="PG">Hollywood</p>
					<p class="year">2018</p>
					<p class="genre">Action</p>
					<p class="time">2h 28m</p>
				</div>
				<p class="disc">Spideramn movie, a great movie must watch u will be gihly obliged wit h this by watching...</p>
				<a href="https://www.imdb.com/title/tt4912910/" target="_blank">Read More</a>
			<div class="social-btn">
        <!-- WATCH TRAILER-->
				<button>
					<i class="fas fa-play"></i> SEE TRAILER
				</button>
				<!-- GET-->
				<button>
					<i class="fas fa-download"></i> DOWNLOAD
				</button>
				<!--USERS RATINGS-->
				<button>
					<i class="fas fa-star"></i> 3
				</button>
				<!--BOOKMARK-->
				<button onclick="getFav(this)" value="60e8ad89660b9c5796bb0734" name="srivastava11735@gmail.com" style="background-color: #e50914;" id="x">
          <i class="fas fa-heart"></i>
				</button>
			</div>	
			</div>
		</div>
		<div class="card_right">
			<div class="img_container">
				<img src="https://upload.wikimedia.org/wikipedia/en/9/97/Ghajini_Hindi.jpg" alt="">
				</div>
				<div class="play_btn">
					<a href="https://www.imdb.com/title/tt4912910/" target="_blank">
						<i class="fas fa-play-circle"></i>
					</a>
				</div>
			</div>
		</div>
    
   
	<div class="main_card" >
		<div class="card_left">
			<div class="card_datails">
				<h1>Loki</h1>
				<div class="card_cat">
					<p class="PG">Hollywood</p>
					<p class="year">2018</p>
					<p class="genre">Action</p>
					<p class="time">2h 28m</p>
				</div>
				<p class="disc">Lokey movie, a great movie must watch u will be gihly obliged wit h this by watching...</p>
				<a href="https://www.imdb.com/title/tt4912910/" target="_blank">Read More</a>
			<div class="social-btn">
        <!-- WATCH TRAILER-->
				<button>
					<i class="fas fa-play"></i> SEE TRAILER
				</button>
				<!-- GET-->
				<button>
					<i class="fas fa-download"></i> DOWNLOAD
				</button>
				<!--USERS RATINGS-->
				<button>
					<i class="fas fa-star"></i> 2.0
				</button>
				<!--BOOKMARK-->
				<button onclick="getFav(this)" value="60f1d7672c91edd2b589dccb" name="srivastava11735@gmail.com" style="background-color: #e50914;" id="x">
          <i class="fas fa-heart"></i>
				</button>
			</div>	
			</div>
		</div>
		<div class="card_right">
			<div class="img_container">
				<img src="https://i.pinimg.com/originals/f9/00/3e/f9003ed1cda6a0b3dbcaeeefc5aeb1aa.jpg" alt="">
				</div>
				<div class="play_btn">
					<a href="https://www.imdb.com/title/tt4912910/" target="_blank">
						<i class="fas fa-play-circle"></i>
					</a>
				</div>
			</div>
		</div>
    
   
	<div class="main_card" >
		<div class="card_left">
			<div class="card_datails">
				<h1>Inception</h1>
				<div class="card_cat">
					<p class="PG">Hollywood</p>
					<p class="year">2018</p>
					<p class="genre">Action</p>
					<p class="time">2h 28m</p>
				</div>
				<p class="disc">Spideramn movie, a great movie must watch u will be gihly obliged wit h this by watching...</p>
				<a href="https://www.imdb.com/title/tt4912910/" target="_blank">Read More</a>
			<div class="social-btn">
        <!-- WATCH TRAILER-->
				<button>
					<i class="fas fa-play"></i> SEE TRAILER
				</button>
				<!-- GET-->
				<button>
					<i class="fas fa-download"></i> DOWNLOAD
				</button>
				<!--USERS RATINGS-->
				<button>
					<i class="fas fa-star"></i> 1.0
				</button>
				<!--BOOKMARK-->
				<button onclick="getFav(this)" value="60e8ae68660b9c5796bb0737" name="srivastava11735@gmail.com" style="background-color: #e50914;" id="x">
          <i class="fas fa-heart"></i>
				</button>
			</div>	
			</div>
		</div>
		<div class="card_right">
			<div class="img_container">
				<img src="https://flxt.tmsimg.com/assets/p7825626_p_v10_af.jpg" alt="">
				</div>
				<div class="play_btn">
					<a href="https://www.imdb.com/title/tt4912910/" target="_blank">
						<i class="fas fa-play-circle"></i>
					</a>
				</div>
			</div>
		</div>
    
	</div>
  </div>
	   


   <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js" integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
   
   <script>
      console.log("inside script")
     
     async function hello(){
       try {
           const  res=await axios.get("/movies/all")
             console.log(res)

            return res
        } catch (error) {
          console.error(error);
        }
     }
     let responseAll;
    hello().then(function (result) {
        console.log(result); // Ooops, the result is undefined
        responseAll = result;
    })
    console.log(responseAll)

    function checkFav(btn) {
    let countFav=0
      
      console.log("running CheckFav")
      console.log(responseAll.data.user.favMovie[0])
      btn.id=countFav.toString()
        console.log(btn.id)
        countFav=parseInt(btn.id)
        console.log(countFav)

      for(let i=0;i<responseAll.data.user.favMovie.length;i++){
          if(responseAll.data.user.favMovie[i].toString()===btn.value.toString()){
              countFav=countFav+1;
              console.log("inside for loop")
              console.log(countFav)
          }
      }
      console.log(countFav)
      
      
      return countFav
    }

      const Form = document.querySelector("form");
      const search=document.getElementById("searchMovie")

      async function getOption(val) {
        event.preventDefault();
       console.log("inside get optioin")
       var output = document.getElementById('output');
              
         
          try {
            const response = await axios.get("/movies",{ params: { sort: val } })
            console.log(response);
            output.className = 'ultimate';
            console
             output.innerHTML = response.data;

         
        } catch (error) {
          console.error(error);
        }
      
  
        }

      Form.addEventListener("submit", (event) => {
        event.preventDefault();
        const movieName = search.value;
        movieName.toLowerCase()
        console.log("inside form")

        async function getUser() {
           var output = document.getElementById('output');
          console.log("inside function")
          console.log(movieName)
          try {
            const response = await axios.get("/movies",{ params: { movieName: movieName } })
            console.log(response);
            output.className = 'ultimate';
            console
              output.innerHTML = response.data;

         
        } catch (error) {
          console.error(error);
        }
      }
      getUser()
      })


      async function getFav(btn) {
        console.log("Insdie getFav")



        
         let x=checkFav(btn)
          console.log(x)
          btn.count=x.toString()

        if(x>0){
            btn.style.backgroundColor='#6a5acd'
            alert("Already Added In Favorite List");
        }else{
        alert("Addedd To Favourite List")
        btn.style.backgroundColor='#6a5acd'

        }


         const Usermail=btn.name
         const movieId=btn.value

         console.log(Usermail)
         console.log(movieId) 

         
         
         console.log("Inside getfav function")
          try {
            const response = await axios.get("/movies/like",
            { params: { id:movieId ,
              _id:Usermail 
              } 
            })
            console.log(response);
            console.log(id)
            output.className = 'ultimate';
            console
              output.innerHTML = response.data;

         
        } catch (error) {
          console.error(error);
        }

       }






      $('.nice-select').each(function() {
  
  var select = $(this),
      name = select.attr('name');
  
  select.hide();
  
  select.wrap('<div class="nice-select-wrap"></div>');
  
  var parent = select.parent('.nice-select-wrap');
  
  parent.append('<ul id=' + name + ' style="display:none"></ul>');
  
  select.find('option').each(function() {

    var option = $(this),
        value = option.attr('value'),
        label = option.text();
    
    if (option.is(":first-child")) {
      
      $('<a href="#" class="drop">' + label + '</a>').insertBefore(parent.find('ul'));
      
    } else {
      
      parent.find('ul').append('<li><a href="#" id="' + value + '">' + label + '</a></li>');
      
    }
    
  });
  
  parent.find('a').on('click', function(e) {
    
    parent.toggleClass('down').find('ul').slideToggle(300);
    
    e.preventDefault();
  
  });
  
  parent.find('ul a').on('click', function(e) {
    
    var niceOption = $(this),
    		value = niceOption.attr('id'),
        text = niceOption.text();
    
    select.val(value);
    console.log(value)
     getOption(value)
    
    parent.find('.drop').text(text);
    
    e.preventDefault();
  
  });
  
});

$('.header').on('click', '.search-toggle', function(e) {
  var selector = $(this).data('selector');

  $(selector).toggleClass('show').find('.search-input').focus();
  $(this).toggleClass('active');

  e.preventDefault();
});

   </script>
</body>
</html>
 
</div>

